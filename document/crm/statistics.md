# 统计分析模块需求文档

## 1. 功能概述

统计分析模块是 CRM 系统的核心功能模块，用于对系统中的各类数据进行统计和分析，帮助用户更好地了解业务情况，做出决策。该模块支持多维度的数据统计和分析，包括客户分析、业绩分析、漏斗分析、排行榜分析等。

## 2. 功能需求

### 2.1 客户分析

#### 2.1.1 客户总量分析
- 按日期统计
  - 新增客户数
  - 累计客户数
  - 客户增长率
- 按用户统计
  - 个人客户数
  - 团队客户数
  - 客户分布情况

#### 2.1.2 客户跟进分析
- 按日期统计
  - 跟进次数
  - 跟进频率
  - 跟进趋势
- 按用户统计
  - 个人跟进情况
  - 团队跟进情况
- 按类型统计
  - 电话跟进
  - 邮件跟进
  - 拜访跟进
  - 其他跟进

#### 2.1.3 客户转化分析
- 首次合同分析
  - 合同数量
  - 合同金额
  - 转化周期
- 回款分析
  - 回款金额
  - 回款周期
  - 回款率

#### 2.1.4 公海客户分析
- 按日期统计
  - 进入公海数量
  - 认领数量
  - 转化率
- 按用户统计
  - 个人认领情况
  - 团队认领情况

#### 2.1.5 客户成交周期分析
- 按日期统计
  - 平均成交周期
  - 最长成交周期
  - 最短成交周期
- 按用户统计
  - 个人成交周期
  - 团队成交周期
- 按地区统计
  - 地区成交周期
  - 地区分布情况
- 按产品统计
  - 产品成交周期
  - 产品分布情况

### 2.2 业绩分析

#### 2.2.1 销售业绩
- 按日期统计
  - 销售额
  - 销售目标
  - 完成率
- 按用户统计
  - 个人业绩
  - 团队业绩
  - 排名情况

#### 2.2.2 回款业绩
- 按日期统计
  - 回款金额
  - 回款目标
  - 完成率
- 按用户统计
  - 个人回款
  - 团队回款
  - 排名情况

### 2.3 漏斗分析

#### 2.3.1 销售漏斗
- 线索转化漏斗
- 商机转化漏斗
- 合同转化漏斗
- 回款转化漏斗

#### 2.3.2 转化率分析
- 各阶段转化率
- 转化周期分析
- 转化趋势分析

### 2.4 排行榜分析

#### 2.4.1 销售排行榜
- 销售额排行
- 回款额排行
- 客户数排行
- 商机数排行

#### 2.4.2 团队排行榜
- 团队业绩排行
- 团队回款排行
- 团队客户排行
- 团队商机排行

### 2.5 权限控制

- 查询权限：crm:statistics:query
- 导出权限：crm:statistics:export

## 3. 数据模型

### 3.1 统计维度
- 时间维度
  - 日期
  - 月份
  - 季度
  - 年度
- 用户维度
  - 个人
  - 团队
  - 部门
- 业务维度
  - 客户
  - 商机
  - 合同
  - 回款
- 产品维度
  - 产品类别
  - 产品
- 地区维度
  - 省份
  - 城市
  - 区域

### 3.2 统计指标
- 数量指标
  - 客户数
  - 商机数
  - 合同数
  - 回款数
- 金额指标
  - 销售额
  - 回款额
  - 目标额
- 比率指标
  - 转化率
  - 完成率
  - 增长率
- 周期指标
  - 成交周期
  - 回款周期
  - 跟进周期

## 4. 接口设计

### 4.1 客户统计接口
- GET /crm/statistics-customer/get-customer-summary-by-date - 获取客户总量分析(按日期)
- GET /crm/statistics-customer/get-customer-summary-by-user - 获取客户总量分析(按用户)
- GET /crm/statistics-customer/get-follow-up-summary-by-date - 获取客户跟进次数分析(按日期)
- GET /crm/statistics-customer/get-follow-up-summary-by-user - 获取客户跟进次数分析(按用户)
- GET /crm/statistics-customer/get-follow-up-summary-by-type - 获取客户跟进次数分析(按类型)
- GET /crm/statistics-customer/get-contract-summary - 获取客户的首次合同、回款信息列表
- GET /crm/statistics-customer/get-pool-summary-by-date - 获取公海客户分析(按日期)
- GET /crm/statistics-customer/get-pool-summary-by-user - 获取公海客户分析(按用户)
- GET /crm/statistics-customer/get-customer-deal-cycle-by-date - 获取客户成交周期(按日期)
- GET /crm/statistics-customer/get-customer-deal-cycle-by-user - 获取客户成交周期(按用户)
- GET /crm/statistics-customer/get-customer-deal-cycle-by-area - 获取客户成交周期(按地区)
- GET /crm/statistics-customer/get-customer-deal-cycle-by-product - 获取客户成交周期(按产品)

## 5. 注意事项

1. 统计数据需要支持实时计算和定时计算
2. 大数据量统计需要考虑性能问题
3. 统计结果需要支持缓存
4. 统计维度需要支持灵活配置
5. 统计指标需要支持自定义
6. 统计结果需要支持导出
7. 统计图表需要支持多种展示方式
8. 统计权限需要支持细粒度控制
9. 统计结果需要支持数据钻取
10. 统计功能需要支持分布式部署 