# 操作日志模块需求文档

## 1. 功能概述

操作日志模块是 CRM 系统的基础功能模块，用于记录和管理系统中各个业务模块的操作日志。该模块支持记录用户的操作行为，包括创建、修改、删除等操作，并提供日志查询功能。

## 2. 功能需求

### 2.1 基础功能

#### 2.1.1 日志记录
- 支持记录以下业务模块的操作日志：
  - 线索管理
  - 客户管理
  - 联系人管理
  - 商机管理
  - 合同管理
  - 产品管理
  - 回款管理
  - 回款计划
- 记录的操作类型包括：
  - 创建操作
  - 修改操作
  - 删除操作
  - 审批操作
  - 分配操作
  - 导出操作

#### 2.1.2 日志查询
- 支持分页查询操作日志
- 支持多条件筛选：
  - 业务类型
  - 业务ID
  - 操作类型
  - 操作人
  - 操作时间
- 支持按业务对象查询日志
- 支持按操作人查询日志

#### 2.1.3 日志详情
- 显示操作日志的完整信息
- 包含：
  - 基本信息
  - 业务信息
  - 操作人信息
  - 操作内容
  - 操作时间
  - 操作结果

### 2.2 高级功能

#### 2.2.1 日志统计
- 支持操作类型统计
- 支持操作人统计
- 支持业务类型统计
- 支持操作趋势分析

#### 2.2.2 日志导出
- 支持导出操作日志
- 支持自定义导出字段
- 支持多种导出格式
- 支持大数据量导出

#### 2.2.3 日志清理
- 支持自动清理过期日志
- 支持手动清理日志
- 支持日志备份
- 支持清理策略配置

### 2.3 权限控制

- 查询权限：crm:operate-log:query
- 导出权限：crm:operate-log:export
- 清理权限：crm:operate-log:clean

## 3. 数据模型

### 3.1 操作日志（OperateLogDO）
- 基本信息
  - 日志ID
  - 业务类型
  - 业务ID
  - 操作类型
  - 操作内容
  - 操作结果
- 操作人信息
  - 操作人ID
  - 操作人名称
  - 操作人部门
- 时间信息
  - 操作时间
  - 操作耗时
- 其他信息
  - 操作IP
  - 操作地点
  - 操作设备
  - 操作浏览器

## 4. 接口设计

### 4.1 操作日志接口
- GET /crm/operate-log/page - 获取操作日志分页列表

## 5. 注意事项

1. 日志记录需要异步处理，避免影响业务性能
2. 日志查询需要支持大数据量
3. 日志导出需要考虑性能问题
4. 日志清理需要支持策略配置
5. 日志记录需要包含完整的操作信息
6. 日志查询需要支持多维度筛选
7. 日志统计需要支持多维度分析
8. 日志备份需要支持定期备份
9. 日志记录需要支持分布式部署
10. 日志查询需要支持权限控制 